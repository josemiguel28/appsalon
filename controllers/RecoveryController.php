<?phpnamespace Controller;use Clases\Email;use Clases\Request;use Model\ActiveRecord;use Model\Usuario;use MVC\Router;class RecoveryController extends ActiveRecord{    public static function olvidePassword(Router $router): void    {        $alertas = [];        if (isPostBack()) {            $auth = new Usuario($_POST);            $alertas = $auth->validarEmail();            if (empty($alertas)) {                //verificar que el email exista                $usuario = Usuario::where('email', $auth->email);                if ($usuario && $usuario->confirmado === '1') {                    $usuario->createToken();                    $usuario->guardar();                    //enviar el email                    $email = new Email($usuario->email, $usuario->nombre, $usuario->token);                    $email->restablecerContrasena();                    Usuario::setAlerta('exito', 'Revisa tu correo para restablecer tu contraseña');                } else {                    Usuario::setAlerta('error', "La cuenta no existe o no esta confirmada");                }            }        }        $alertas = Usuario::getAlertas();        $router->render('auth/olvidePassword',            [                "alertas" => $alertas            ]);    }    public static function recuperarPassword(Router $router): void    {        $token = '';        $alertas = '';        $error = false;        $request = new Request();        $token = $request->get('token');        //buscar usuario por token        $usuario = Usuario::where('token', $token);        if (empty($usuario)) {            Usuario::setAlerta('error', 'Token no valido');            $error = true;        }        if (isPostBack()) {            //leer la nueva contraseña            $password = new Usuario($_POST);            $alertas = $usuario->validarPassword($password->password);            if (empty($alertas)) {                $usuario->password = null;                $usuario->password = $password->password;                $usuario->token = '';                $usuario->hashPassword();                $resultado = $usuario->guardar();                if ($resultado) {                    redirectToWithMsg('/', 'La contraseña se actualizo correctamente');                }            }        }        $alertas = Usuario::getAlertas();        $router->render('auth/recuperar-password',            [                "alertas" => $alertas,                "error" => $error            ]);    }}